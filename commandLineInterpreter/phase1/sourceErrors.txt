COPY    START   1000		COPY FILE FROM INPUT TO OUTPUT
FIRST   STL     RETADR		SAVE RETURN ADDRESS
CLOOP   JSUB    RDREC		READ INPUT RECORD
	LDA	LENGTH		TEST FOR EOF (LENGTH = 0)
	COMP    ZERO
	JEQ     ENDFIL		EXIT IF EOF FOUND
	JSUB	WRREC		WRITE OUTPUT RECORD
	J       CLOOP		LOOP
ENDFIL  LDA     EOF		INSERT END OF FILE MARKER
	STA     BUFFER

	LDA     THREE		SET LENGTH = 3
	STA     LENGTH
	JSUB    WRREC		WRITE EOF
	LDL     RETADR		GET RETURN ADDRESS

	RSUB             	RETURN TO CALLER
THING2 START 100 WHY ARE WE STARTING AGAIN THO?
EOF     BYTE    C'EOF'
ZERO    WORD    0
THREE   WORD    
RETADR  RESW    1
LENGTH  RESW    1		LENGTH OF RECORD
BUFFER  RESB    465		4096-BYTE BUFFER AREA
BUFFER2  RESB    40Z6		4096-BYTE BUFFER AREA
.
.	SUBROUTINE TO READ RECORD INTO BUFFER
.
RDREC   LDX     ZERO		CLEAR LOOP COUNTER
	LDA     ZERO		CLEAR A TO ZERO
RLOOP   TD      INPUT		TEST INPUT DEVICE
	JEQ     RLOOP		LOOP UNTIL READY
	RD      INPUT		READ CHARACTER INTO REGISTAR A
	COMP    ZERO		TEST FOR END OF RECORD (X'00')
	COMP
	COMP 2Z35
	COMP 343
	COMP 0A432
	COMP 3435
	JEQ     EXIT		EXIT LOOP IF EOF
	STCH    BUFFER,X	STORE CHARCTER IN BUFFER
	TIX     MAXLEN		LOOP UNLESS MAX LENGTH
	JLT     RLOOP	  	  HAS BEEN REACHED
TOOLONGBRO SOMEINVALIDOP
EXIT    STX     LENGTH		SAVE RECORD LENGTH
	RSUB                    RETURN TO CALLER
INPUT
INPUT   BYTE    X'F1'		CODE FOR INPUT DEVICE
INPUT2   BYTE    C'01234567890123456789012345678901234567890123456789'		CODE FOR INPUT DEVICE
INPUT3   BYTE    X'123456781234567812345678123456789999'		CODE FOR INPUT DEVICE
INPUT4   BYTE    X'ABC'		CODE FOR INPUT DEVICE
INPUT5   BYTE    A'ABC2'		CODE FOR INPUT DEVICE
INPUT6   BYTE    X'ABCZ'		CODE FOR INPUT DEVICE
MAXLEN	WORD	40593
MAXLEN	WORD	4Z59
.
.	SUBROUTINE TO WRITE RECORD FROM BUFFER
.
WRREC   LDX    ZERO		CLEAR LOOP COUNTER
9TESTS
WLOOP   TD     OUTPUT		TEST OUTPUT DEVICE
	JEQ    WLOOP		LOOP UNTIL READY
	LDCH   BUFFER,X	        GET CHARCTER FROM BUFFER
	WD     OUTPUT		WRITE CHARACTER
	TIX    LENGTH		LOOP UNTIL ALL CHARACTERS
	JLT    WLOOP	  	  HAVE BEEN WRITTEN
	RSUB                    RETURN TO CALLER
OUTPUT  BYTE   X'05'		CODE FOR OUTPUT DEVICE
	ENDED    FIRST